@using Microsoft.AspNetCore.Hosting
@using Microsoft.AspNetCore.Mvc.ViewEngines
@inject IWebHostEnvironment Environment
@inject ICompositeViewEngine Engine
@using Microsoft.AspNetCore.Authorization
@inject IAuthorizationService AuthorizationService
@using ModelData.Services;
@inject ISettingsService SettingsService
@inject ICategoryServices CategoryServices
@inject IWebPageService WebPageService
@inject IPostServices PostServices

@using Microsoft.AspNetCore.Identity
@using ModelData.Models  <!-- Replace with actual namespace -->
@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager

@{
    ModelData.Models.Setting siteSettings = await SettingsService.GetSettingsAsync();
    List<ModelData.Models.Category> itemCategories = await CategoryServices.GetCategoriesAsync();
    List<ModelData.Models.WebPage> itemWebPages = await WebPageService.GetPublishedPages();
    List<ModelData.Models.Post> itemPost = await PostServices.GetPublishedPosts();
    List<ModelData.Models.Post> mostViewdPosts = await PostServices.GetTopViewedPostsAsync(count: 3);
    List<ModelData.Models.Post> breakingNew = await PostServices.GetBrakingNews(count: 10);
    var plainDescription = System.Text.RegularExpressions.Regex.Replace(siteSettings.SiteDescription ?? "", "<.*?>", "");
}


<!DOCTYPE html>
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers no-applicationcache svg inlinesvg smil svgclippaths" lang="" style="">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>
        @($"{ViewBag.Title} | {siteSettings.SiteTitle} | {plainDescription}")
    </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <partial name="_MetaTags" />
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="@siteSettings.FaviconUrl">
    <!-- Normalize CSS -->
    <link rel="stylesheet" href="~/assets/normalize.css">
    <!-- Main CSS -->
    <link rel="stylesheet" href="~/assets/main.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="~/assets/bootstrap.min.css">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="~/assets/animate.min.css">
    <!-- Font-awesome CSS-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <!-- Owl Caousel CSS -->
    <link rel="stylesheet" href="~/assets/owl.carousel.min.css">
    <link rel="stylesheet" href="~/assets/owl.theme.default.min.css">
    <!-- Main Menu CSS -->
    <link rel="stylesheet" href="~/assets/meanmenu.min.css">
    <!-- Magnific CSS -->
    <link rel="stylesheet" type="text/css" href="~/assets/magnific-popup.css">
    <!-- Switch Style CSS -->
    <link rel="stylesheet" href="~/assets/hover-min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="~/assets/style.css">
    <!-- For IE -->
    <link rel="stylesheet" type="text/css" href="~/assets/ie-only.css">
    <!-- Modernizr Js -->
    <script src="~/assets/modernizr-2.8.3.min.js"></script>
    <link href="~/css/site.css" rel="stylesheet" />
    <link href="~/_content/AdminUI/css/web.css" rel="stylesheet" />

    <style>
        @Html.Raw(siteSettings.CustomCSS)
    </style>
     @Html.Raw(siteSettings.CustomHeadScript)
    @Html.Raw(siteSettings.GoogleAnalyticsId)
    @Html.Raw(siteSettings.GoogleTagManagerId)
    @Html.Raw(siteSettings.FacebookPixelId)

</head>

<body>
    @Html.Raw(siteSettings.CustomJS)
    @if (siteSettings.EnableLiveChat)
    {
        @siteSettings.LiveChatScript
    }
    <div id="wrapper" class="wrapper">
        <!-- Header Area Start Here -->
        <header>
            <div id="header-layout1" class="header-style1">
                <div class="main-menu-area bg-primarytextcolor header-menu-fixed" id="sticker">
                    <div class="container-fluid">
                        <div class="row no-gutters d-flex align-items-center">
                            <div class="col-lg-2 d-none d-lg-block">
                                <div class="logo-area">
                                    <a href="">
                                        <img src="@siteSettings.SiteLogoUrl" alt="@siteSettings.SiteTitle" class="img-fluid">
                                    </a>
                                </div>
                            </div>
                            <div class="col-xl-8 col-lg-7 position-static min-height-none">
                                <div class="ne-main-menu">
                                    <nav id="dropdown" style="display: block;">
                                        <ul>
                                            <li>
                                                <a href="/">Home</a>
                                            </li>
                                            @foreach (var sitepage in itemWebPages.Where(x => x.ShowInMenu == true).Where(x => x.MenuSortOrder > 0))
                                            {
                                                <li>
                                                    @if (sitepage.EnableDirectLink)
                                                    {
                                                        <a href="@sitepage.DirectLinkUrl" target="@(sitepage.DirectLinkOpenInNewTab ? "_blank" : "_self")">@sitepage.Title</a>

                                                    }
                                                    else
                                                    {
                                                        <a asp-page="/Webpage" asp-route-slug="@sitepage.Slug">@sitepage.Title</a>
                                                    }
                                                </li>
                                            }

                                            @foreach (var sitecategory in itemCategories.Where(x => x.ShowInMenu == true))
                                            {
                                                <li>
                                                    @if (sitecategory.Children.Count() > 0)
                                                    {

                                                        <a href="#">@sitecategory.Title</a>

                                                        <ul class="ne-dropdown-menu">
                                                            @foreach (var list in sitecategory.Children.Where(x => x.IsPublished == true))
                                                            {
                                                                <li>
                                                                    <a asp-page="/CategoryPage" asp-route-slug="@list.Slug">@list.Title</a>
                                                                </li>
                                                            }
                                                        </ul>
                                                    }
                                                    else
                                                    {
                                                        <a asp-page="/CategoryPage" asp-route-slug="@sitecategory.Slug">@sitecategory.Title</a>
                                                    }

                                                </li>
                                            }

                                            @foreach (var sitepage in itemWebPages.Where(x => x.ShowInMenu == true).Where(x => x.MenuSortOrder < 0))
                                            {
                                                <li>
                                                    @if (sitepage.EnableDirectLink)
                                                    {
                                                        <a href="@sitepage.DirectLinkUrl" target="@(sitepage.DirectLinkOpenInNewTab ? "_blank" : "_self")">@sitepage.Title</a>

                                                    }
                                                    else
                                                    {
                                                        <a asp-page="/Webpage" asp-route-slug="@sitepage.Slug">@sitepage.Title</a>
                                                    }
                                                </li>
                                            }
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-3 col-md-12 text-right position-static">
                                <div class="header-action-item">
                                    <ul>
                                        <li>
                                            <a class="search-button" asp-page="/Search">
                                                <i class="fa fa-search" aria-hidden="true"></i>
                                            </a>

                                        </li>
                                        <partial name="_LoginPartial" />
                                        @if (User.Identity.IsAuthenticated)
                                        {
                                            <li>

                                                <a href="javascript:document.getElementById('logoutForm').submit()" class="search-button"> <i class="fa fa-sign-out"></i> </a>
                                            </li>
                                        }
                                        <li>
                                            <div id="side-menu-trigger" class="offcanvas-menu-btn">
                                                <a href="#" class="menu-bar">
                                                    <span></span>
                                                    <span></span>
                                                    <span></span>
                                                </a>
                                                <a href="#" class="menu-times close">
                                                    <span></span>
                                                    <span></span>
                                                </a>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Header Area End Here -->
        <form asp-area="Identity" id="logoutForm" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Account/Login", new { area = "Identity" })" method="post">
        </form>
        <!-- News Feed Area Start Here -->

        <section class="bg-accent border-bottom add-top-margin mq-height" style="">
            <div class="container">
                <div class="row no-gutters d-flex align-items-center">
                    <div class="col-lg-2 col-md-3 col-sm-4 col-6">
                        <div class="topic-box topic-box-margin">Top Stories</div>
                    </div>
                    <div class="col-lg-10 col-md-9 col-sm-8 col-6">
                        <div class="feeding-text-dark">
                            <div class="marquee-container">
                                <div class="marquee-content ticker-content">
                                    @foreach (var item in breakingNew)
                                    {
                                        <a asp-page="/PostPage" asp-route-slug="@item.Slug">@item.Title</a>
                                    }
                                    @* Duplicate items for seamless looping *@
                                    @foreach (var item in breakingNew)
                                    {
                                        <a asp-page="/PostPage" asp-route-slug="@item.Slug">@item.Title</a>
                                    }
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- News Feed Area End Here -->
        <!-- News Info List Area Start Here -->
        <section class="bg-body">
            <div class="container">
                <ul class="news-info-list text-center--md">
                    <li>
                        <i class="fa fa-calendar" aria-hidden="true"></i>
                        <span id="current_date">Loading date...</span>
                    </li>
                    <li>
                        <i class="fa fa-clock-o" aria-hidden="true"></i>
                        <span id="last_update_time">Loading time...</span>
                    </li>
                </ul>
            </div>
        </section>


        <!-- News Info List Area End Here -->

        @RenderBody()


        <!-- Footer Area Start Here -->
        <footer>
            <div class="footer-area-top">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-4 col-md-4 col-sm-12">
                            <div class="footer-box">
                                <h2 class="title-bold-light title-bar-left text-uppercase">Most Viewed Posts</h2>
                                <ul class="most-view-post">
                                    @foreach (var item in mostViewdPosts)
                                    {
                                        <li>
                                            <div class="media">
                                                <a asp-page="/PostPage" asp-route-slug="@item.Slug">
                                                    @{
                                                        var defaultImage = item.PostImages?.FirstOrDefault(x => x.IsDefault);
                                                    }

                                                    <img src="@(defaultImage?.ImageUrl ?? "/default/default.jpg")"
                                                         alt="@item.Title"
                                                         class="img-fluid" style="max-height:70px;" />

                                                </a>
                                                <div class="media-body">
                                                    <h3 class="title-medium-light size-md mb-10">
                                                        <a asp-page="/PostPage" asp-route-slug="@item.Slug">@item.Title</a>
                                                    </h3>
                                                    <div class="post-date-light">
                                                        <ul>
                                                            <li>
                                                                <span>
                                                                    <i class="fa fa-calendar" aria-hidden="true"></i>
                                                                </span>@(item.PublishedAt.HasValue
    ? item.PublishedAt.Value.ToString("MMM dd yyyy")
    : "")

                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    }

                                </ul>
                            </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12">
                            <div class="footer-box">
                                <h2 class="title-bold-light title-bar-left text-uppercase">Popular Categories</h2>
                                <ul class="popular-categories">
                                    @foreach (var cat in itemCategories.Where(x => x.ShowInFooter))
                                    {
                                        <li>
                                            <a asp-page="/CategoryPage" asp-route-slug="@cat.Slug">
                                                @cat.Title
                                                <span>@(cat.Posts?.Count ?? 0)</span>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </div>
                        </div>

                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-12">
                            <div class="footer-box">
                                <h2 class="title-bold-light title-bar-left text-uppercase">Pages</h2>
                                <ul class="popular-categories">
                                    @foreach (var xpage in itemWebPages.Where(x => x.ShowInFooter))
                                    {
                                        <li>


                                            @if (xpage.EnableDirectLink)
                                            {
                                                <a href="@xpage.DirectLinkUrl" target="@(xpage.DirectLinkOpenInNewTab ? "_blank" : "_self")"> <i class="fa fa-globe" aria-hidden="true"></i> @xpage.Title</a>

                                            }
                                            else
                                            {
                                                <a asp-page="/Webpage" asp-route-slug="@xpage.Slug"> <i class="fa fa-globe" aria-hidden="true"></i> @xpage.Title</a>
                                            }
                                        </li>


                                    }
                                </ul>
                            </div>
                        </div>

                        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12">
                            <div class="footer-box">
                                <h2 class="title-bold-light title-bar-left text-uppercase">Contact Us</h2>
                                <ul class="popular-categories">
                                    @if (!string.IsNullOrWhiteSpace(siteSettings.ContactEmail))
                                    {
                                        <li><i class="fa fa-envelope"></i> @Html.Raw(siteSettings.ContactEmail)</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(siteSettings.ContactPhone))
                                    {
                                        <li><i class="fa fa-phone"></i> @Html.Raw(siteSettings.ContactPhone)</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(siteSettings.Address))
                                    {
                                        <li><i class="fa fa-map-marker"></i> @Html.Raw(siteSettings.Address)</li>
                                    }
                                </ul>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="footer-area-bottom">
                <div class="container">
                    <div class="row">
                        <div class="col-12 text-center">
                            <a href="/" class="footer-logo img-fluid">
                                <img src="@siteSettings.SiteLogoUrl" alt="@siteSettings.SiteTitle" class="img-fluid">
                            </a>
                            <ul class="footer-social">
                                @if (!string.IsNullOrWhiteSpace(siteSettings.FacebookUrl))
                                {
                                    <li>
                                        <a href="@siteSettings.FacebookUrl" title="Facebook" target="_blank">
                                            <i class="fa fa-facebook" aria-hidden="true"></i>
                                        </a>
                                    </li>
                                }

                                @if (!string.IsNullOrWhiteSpace(siteSettings.TwitterUrl))
                                {
                                    <li>
                                        <a href="@siteSettings.TwitterUrl" title="Twitter" target="_blank">
                                            <i class="fa fa-twitter" aria-hidden="true"></i>
                                        </a>
                                    </li>
                                }

                                @if (!string.IsNullOrWhiteSpace(siteSettings.LinkedInUrl))
                                {
                                    <li>
                                        <a href="@siteSettings.LinkedInUrl" title="LinkedIn" target="_blank">
                                            <i class="fa fa-linkedin" aria-hidden="true"></i>
                                        </a>
                                    </li>
                                }

                                @if (!string.IsNullOrWhiteSpace(siteSettings.InstagramUrl))
                                {
                                    <li>
                                        <a href="@siteSettings.InstagramUrl" title="Instagram" target="_blank">
                                            <i class="fa fa-instagram" aria-hidden="true"></i>
                                        </a>
                                    </li>
                                }

                                @if (!string.IsNullOrWhiteSpace(siteSettings.YouTubeUrl))
                                {
                                    <li>
                                        <a href="@siteSettings.YouTubeUrl" title="YouTube" target="_blank">
                                            <i class="fa fa-youtube" aria-hidden="true"></i>
                                        </a>
                                    </li>
                                }

                                @if (!string.IsNullOrWhiteSpace(siteSettings.TikTokUrl))
                                {
                                    <li>
                                        <a href="@siteSettings.TikTokUrl" title="TikTok" target="_blank">
                                            <i class="fa fa-music" aria-hidden="true"></i>
                                        </a>
                                    </li>
                                }
                            </ul>


                        </div>
                    </div>
                    @{
                        var widgets = new List<string>();

                        if (!string.IsNullOrWhiteSpace(siteSettings.FacebookWidget)) widgets.Add(siteSettings.FacebookWidget);
                        if (!string.IsNullOrWhiteSpace(siteSettings.TwitterWidget)) widgets.Add(siteSettings.TwitterWidget);
                        if (!string.IsNullOrWhiteSpace(siteSettings.InstagramWidget)) widgets.Add(siteSettings.InstagramWidget);
                        if (!string.IsNullOrWhiteSpace(siteSettings.YouTubeWidget)) widgets.Add(siteSettings.YouTubeWidget);
                        if (!string.IsNullOrWhiteSpace(siteSettings.LinkedInWidget)) widgets.Add(siteSettings.LinkedInWidget);
                        if (!string.IsNullOrWhiteSpace(siteSettings.TikTokWidget)) widgets.Add(siteSettings.TikTokWidget);

                        int count = widgets.Count;
                        string columnClass = count switch
                        {
                            1 => "col-12 text-center",   // Full width, center
                            2 => "col-md-6",            // Two equal columns
                            3 => "col-md-4",            // Three equal columns
                            4 => "col-md-3",            // Four equal columns
                            5 => "col",                 // Auto for 5
                            6 => "col-md-2",            // Six equal columns
                            _ => "col"                  // Default fallback
                        };
                    }

                    <div class="row g-4 justify-content-center">
                        @foreach (var widget in widgets)
                        {
                            <div class="@columnClass">
                                @Html.Raw(widget)
                            </div>
                        }
                    </div>
                    <div class="row">
                        <div class="col-12 text-center">

                            <p>© @DateTime.UtcNow.Year @siteSettings.SiteTitle. All Rights Reserved</p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Footer Area End Here -->
        <!-- Offcanvas Menu Start -->
        <div id="offcanvas-body-wrapper" class="offcanvas-body-wrapper">
            <div id="offcanvas-nav-close" class="offcanvas-nav-close offcanvas-menu-btn">
                <a href="#" class="menu-times re-point">
                    <span></span>
                    <span></span>
                </a>
            </div>
            <div class="offcanvas-main-body">
                <ul id="accordion" class="offcanvas-nav panel-group">
                    <li>
                        <a href="/">
                            <i class="fa fa-home" aria-hidden="true"></i>Home
                        </a>
                    </li>
                    @foreach (var sitepage in itemWebPages.Where(x => x.ShowInMenu == true).Where(x => x.MenuSortOrder > 0))
                    {
                        <li>
                            @if (sitepage.EnableDirectLink)
                            {
                                <a href="@sitepage.DirectLinkUrl" target="@(sitepage.DirectLinkOpenInNewTab ? "_blank" : "_self")"><i class="fa fa-globe" aria-hidden="true"></i> @sitepage.Title</a>

                            }
                            else
                            {
                                <a asp-page="/Webpage" asp-route-slug="@sitepage.Slug"><i class="fa fa-globe" aria-hidden="true"></i> @sitepage.Title</a>
                            }
                        </li>
                    }
                    @foreach (var sitecategory in itemCategories.Where(x => x.ShowInMenu == true))
                    {
                        @if (sitecategory.Children.Count() > 0)
                        {


                            <li class="panel panel-default">
                                <div class="panel-heading">
                                    <a aria-expanded="false" class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                        <i class="fa fa-globe" aria-hidden="true"></i>@sitecategory.Title
                                    </a>
                                </div>
                                <div aria-expanded="false" id="collapseOne" role="tabpanel" class="panel-collapse collapse">
                                    <div class="panel-body">
                                        <ul class="offcanvas-sub-nav">
                                            @foreach (var list in sitecategory.Children.Where(x => x.IsPublished == true))
                                            {
                                                <li>
                                                    <a asp-page="/CategoryPage" asp-route-slug="@list.Slug">@list.Title</a>
                                                </li>

                                            }
                                        </ul>
                                    </div>
                                </div>
                            </li>


                        }
                        else
                        {
                            <li>
                                <a asp-page="/CategoryPage" asp-route-slug="@sitecategory.Slug">
                                    <i class="fa fa-globe" aria-hidden="true"></i>@sitecategory.Title
                                </a>
                            </li>

                        }

                    }

                    @foreach (var sitepage in itemWebPages.Where(x => x.ShowInFooter == true).Where(x => x.MenuSortOrder < 0))
                    {
                        <li>
                            @if (sitepage.EnableDirectLink)
                            {
                                <a href="@sitepage.DirectLinkUrl" target="@(sitepage.DirectLinkOpenInNewTab ? "_blank" : "_self")"> <i class="fa fa-globe" aria-hidden="true"></i>@sitepage.Title</a>

                            }
                            else
                            {
                                <a asp-page="/Webpage" asp-route-slug="@sitepage.Slug"> <i class="fa fa-globe" aria-hidden="true"></i>@sitepage.Title</a>
                            }
                        </li>
                    }


                </ul>
            </div>
        </div>
        <!-- Offcanvas Menu End -->
    </div>
    <!-- Wrapper End -->
    <!-- jquery-->
    <script src="~/assets/jquery-2.2.4.min.js" type="text/javascript"></script>
    <!-- Plugins js -->
    <script src="~/assets/plugins.js" type="text/javascript"></script>
    <!-- Popper js -->
    <script src="~/assets/popper.js" type="text/javascript"></script>
    <!-- Bootstrap js -->
    <script src="~/assets/bootstrap.min.js" type="text/javascript"></script>
    <!-- WOW JS -->
    <script src="~/assets/wow.min.js"></script>
    <!-- Owl Cauosel JS -->
    <script src="~/assets/owl.carousel.min.js" type="text/javascript"></script>
    <!-- Meanmenu Js -->
    <script src="~/assets/jquery.meanmenu.min.js" type="text/javascript"></script>
    <!-- Srollup js -->
    <script src="~/assets/jquery.scrollUp.min.js" type="text/javascript"></script>
    <!-- jquery.counterup js -->
    <script src="~/assets/jquery.counterup.min.js"></script>
    <script src="~/assets/waypoints.min.js"></script>
    <!-- Isotope js -->
    <script src="~/assets/isotope.pkgd.min.js" type="text/javascript"></script>
    <!-- Magnific Popup -->
    <script src="~/assets/jquery.magnific-popup.min.js"></script>
    <!-- Ticker Js -->
    <script src="~/assets/ticker.js" type="text/javascript"></script>
    <!-- Custom Js -->
    <script src="~/assets/main.js" type="text/javascript"></script>
    <script>
       $(document).ready(function () {
           $("nav#dropdown").meanmenu({
               siteLogo: `
            <div class="mobile-menu-nav-back">
                <a href="/" class="logo-mobile">
                    <img src="@siteSettings.SiteLogoUrl" alt="Mobile Logo" />
                </a>
            </div>
        `
           });
       });

    </script>
    <script>
        // Update date
        const dateElement = document.getElementById("current_date");
        const now = new Date();
        const dateOptions = { weekday: 'long', month: 'short', day: 'numeric', year: 'numeric' };
        dateElement.textContent = now.toLocaleDateString('en-US', dateOptions);

        // Update time
        const timeElement = document.getElementById("last_update_time");
        timeElement.textContent = `Last Update ${now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
    </script>

    <a id="scrollUp" href="#top" style="position: fixed; z-index: 2147483647; display: none;"><i class="fa fa-angle-double-up"></i></a>

    <script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Initialize isotope
            var $grid = $('.featuredContainer').isotope({
                itemSelector: '.row',  // Each post container is a "row"
                layoutMode: 'fitRows'
            });

            // Handle tab clicks
            $('.isotop-btn').on('click', 'a', function (e) {
                e.preventDefault();

                // Remove active state from all tabs
                $('.isotop-btn a').removeClass('current');

                // Add active state to clicked tab
                $(this).addClass('current');

                // Get the filter value
                var filterValue = $(this).attr('data-filter');

                // Apply filter
                $grid.isotope({ filter: filterValue });
            });

            // Optional: show only the first tab's items on page load
            var firstFilter = $('.isotop-btn a').first().attr('data-filter');
            $grid.isotope({ filter: firstFilter });
        });
    </script>
    <script>
        $(document).on("click", "#subscribeBtn", function () {
            var email = $("#newsletterEmail").val();
            var token = $("#__RequestVerificationToken").val();
            var messageEl = $("#subscribeMessage");

            $.ajax({
                type: "POST",
                url: "/Index?handler=Subscribe",
                data: {
                    NewsletterEmail: email,
                    __RequestVerificationToken: token
                },
                success: function (res) {
                    messageEl.text(res.message);
                    messageEl.css("color", res.success ? "lightgreen" : "yellow");
                    if (res.success) {
                        $("#newsletterEmail").val("");
                    }
                },
                error: function () {
                    messageEl.text("Something went wrong.").css("color", "red");
                }
            });
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)

    @Html.Raw(siteSettings.CustomFooterScript)

</body>
</html>
@page
@model AdminUI.Areas_Admin_Pages_WebPages.IndexModel

@{
    ViewData["Title"] = "Web Pages";
}

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">Web Pages (@Model.WebPage.Count())</h2>
        <a class="btn btn-primary" asp-page="Create">
            <i class="bi bi-plus-circle"></i> Create New
        </a>
    </div>
    <form method="get" class="mb-3">
        <div class="input-group">
            <input type="text" class="form-control" name="Search" value="@Model.Search" placeholder="Search pages..." />
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>
    <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle">
            <thead class="table-light">
                <tr>
                    <th>S/N</th>
                    <th>Title</th>
                    <th>Published</th>
                    <th>Show In Menu</th>
                    <th>Show In Footer</th>
                    <th>Menu Sort Order</th>
                    <th>Sort Order</th>
                    <th>Form</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @{ int sn = 0;}

                @foreach (var item in Model.WebPage)
                {
                    <tr>
                        <td>
                            @{ sn++;}
                            @sn
                        </td>
                        <td>
                            <a asp-page="./Details" asp-route-id="@item.Id" asp-route-title="@item.Slug" class="text-decoration-none fw-bold">
                                @item.Title
                            </a>
                        </td>
                        <td>@Html.DisplayFor(modelItem => item.IsPublished)</td>
                        <td>@Html.DisplayFor(modelItem => item.ShowInMenu)</td>
                        <td>@Html.DisplayFor(modelItem => item.ShowInFooter)</td>
                        <td>@Html.DisplayFor(modelItem => item.MenuSortOrder)</td>
                        <td>@Html.DisplayFor(modelItem => item.SortOrder)</td>
                        <td>
                            @if (item.Form != null)
                            {
                                <a asp-area="Admin" asp-page="/Forms/Responses" asp-route-id="@item.Form.Id">
                                    @item.Form.Title
                                </a>
                            }
                            else
                            {
                                <span class="text-muted">No Form</span>
                            }
                        </td>


                        <td>
                            <div class="btn-group btn-group-sm">
                                <a class="btn btn-outline-primary" asp-page="./Edit" asp-route-id="@item.Id" asp-route-title="@item.Slug">Edit</a>
                                <a class="btn btn-outline-danger" asp-page="./Delete" asp-route-id="@item.Id">Delete</a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        @if (Model.TotalPages > 1)
        {
            <nav style="margin-top:20px;">
                <ul class="pagination">

                    <!-- First page «« -->
                    <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : "")">
                        <a class="page-link" href="?PageNumber=1&Search=@Model.Search">&laquo;&laquo;</a>
                    </li>

                    <!-- Previous page « -->
                    <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : "")">
                        <a class="page-link" href="?PageNumber=@(Model.CurrentPage - 1)&Search=@Model.Search">&laquo;</a>
                    </li>

                    <!-- First 3 pages -->
                    @for (int i = 1; i <= Math.Min(3, Model.TotalPages); i++)
                    {
                        <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                            <a class="page-link" href="?PageNumber=@i&Search=@Model.Search">@i</a>
                        </li>
                    }

                    <!-- Ellipsis -->
                    @if (Model.TotalPages > 6)
                    {
                        <li class="page-item disabled"><span class="page-link">...</span></li>
                    }

                    <!-- Last 3 pages -->
                    @for (int i = Model.TotalPages - 2; i <= Model.TotalPages; i++)
                    {
                        if (i > 3)
                        {
                            <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                                <a class="page-link" href="?PageNumber=@i&Search=@Model.Search">@i</a>
                            </li>
                        }
                    }

                    <!-- Next page » -->
                    <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
                        <a class="page-link" href="?PageNumber=@(Model.CurrentPage + 1)&Search=@Model.Search">&raquo;</a>
                    </li>

                    <!-- Last page »» -->
                    <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
                        <a class="page-link" href="?PageNumber=@Model.TotalPages&Search=@Model.Search">&raquo;&raquo;</a>
                    </li>

                </ul>
            </nav>
        }

    </div>
</div>

@section Scripts {
 }

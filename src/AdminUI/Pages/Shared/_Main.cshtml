@using Microsoft.AspNetCore.Hosting
@using Microsoft.AspNetCore.Mvc.ViewEngines
@inject IWebHostEnvironment Environment
@inject ICompositeViewEngine Engine
@using Microsoft.AspNetCore.Authorization
@inject IAuthorizationService AuthorizationService
@using ModelData.Services;
@inject ISettingsService SettingsService

@using Microsoft.AspNetCore.Identity
@using ModelData.Models  <!-- Replace with actual namespace -->
@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager

@{


    ModelData.Models.Setting siteSettings = await SettingsService.GetSettingsAsync();
    var plainDescription = System.Text.RegularExpressions.Regex.Replace(siteSettings.SiteDescription ?? "", "<.*?>", "");


}

<!doctype html>
<html lang="en">
<!--begin::Head-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>
        @($"Admin Dashboard | {ViewBag.Title} | {siteSettings.SiteTitle} | {plainDescription}")
    </title>
    <link rel="icon" href="@siteSettings.FaviconUrl" type="image/x-icon" />
    <!--begin::Primary Meta Tags-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="title" content="@siteSettings.SiteTitle | @siteSettings.SiteDescription" />
    <meta name="author" content="ColorlibHQ" />
    <meta name="description"
          content="@siteSettings.MetaDescription" />
    <meta name="keywords"
          content="@siteSettings.MetaKeywords" />
    <!--end::Primary Meta Tags-->
    <!--begin::Fonts-->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/@@fontsource/source-sans-3@5.0.12/index.css"
          integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q="
          crossorigin="anonymous" />
    <!--end::Fonts-->
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/styles/overlayscrollbars.min.css"
          integrity="sha256-tZHrRjVqNSRyWg2wbppGnT833E/Ys0DHWGwT04GiqQg="
          crossorigin="anonymous" />
    <!--end::Third Party Plugin(OverlayScrollbars)-->
    <!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
          integrity="sha256-9kPW/n5nn53j4WMRYAxe9c1rCY96Oogo/MKSVdKzPmI="
          crossorigin="anonymous" />
    <!--end::Third Party Plugin(Bootstrap Icons)-->
    <!--begin::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="~/_content/AdminUI/dist/css/adminlte.css" />
    <!--end::Required Plugin(AdminLTE)-->
    <!-- apexcharts -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css"
          integrity="sha256-4MX+61mt9NVvvuPjUWdUdyfZfxSB1/Rf9WtqRHgG5S0="
          crossorigin="anonymous" />
    <!-- jsvectormap -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/jsvectormap@1.5.3/dist/css/jsvectormap.min.css"
          integrity="sha256-+uGLJmmTKOqBr+2E6KDYs/NRsHxSkONXFHUL0fy2O/4="
          crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
    @*<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
        <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css" />*@
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote-lite.min.css" rel="stylesheet" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />

    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />

    <!-- Buttons extension CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.dataTables.min.css" />


    <style>
        .fade-out {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
    </style>
    <link href="~/_content/AdminUI/css/site.css" rel="stylesheet" />
</head>
<!--end::Head-->
<!--begin::Body-->
<body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <!--begin::Preloader Spinner-->
    <div id="preloader" class="position-fixed top-0 start-0 w-100 h-100 bg-white d-flex align-items-center justify-content-center"
         style="z-index: 9999;">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
    <!--end::Preloader Spinner-->
    <!--begin::App Wrapper-->
    <div class="app-wrapper">
        <!--begin::Header-->
        <nav class="app-header navbar navbar-expand bg-body">
            <!--begin::Container-->
            <div class="container-fluid">
                <!--begin::Start Navbar Links-->
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button">
                            <i class="bi bi-list"></i>
                        </a>
                    </li>

                </ul>
                <!--end::Start Navbar Links-->
                <!--begin::End Navbar Links-->
                <ul class="navbar-nav ms-auto">
                    <!--begin::Navbar Search-->
                    <li class="nav-item">
                        <a class="nav-link" data-widget="navbar-search" asp-area="Admin" asp-page="/SearchPanel/Index" role="button">
                            <i class="bi bi-search"></i>
                        </a>
                    </li>
                    <!--end::Navbar Search-->
                    <!--begin::Fullscreen Toggle-->
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                            <i data-lte-icon="maximize" class="bi bi-arrows-fullscreen"></i>
                            <i data-lte-icon="minimize" class="bi bi-fullscreen-exit" style="display: none"></i>
                        </a>
                    </li>
                    <!--end::Fullscreen Toggle-->
                    <!--begin::User Menu Dropdown-->
                    <li class="nav-item dropdown user-menu">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <img src="@siteSettings.FaviconUrl"
                                 class="user-image rounded-circle shadow"
                                 alt="User Image" />
                            <span class="d-none d-md-inline">@User.FindFirst("FullName")?.Value</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end">

                            <li class="user-footer">
                                <a href="javascript:document.getElementById('logoutForm').submit()" class="btn btn-default btn-flat float-end">Sign out</a>
                            </li>
                        </ul>
                        <!--</ul>-->
                    </li>
                    <!--end::User Menu Dropdown-->
                </ul>
                <!--end::End Navbar Links-->
            </div>
            <!--end::Container-->
        </nav>
        <!--end::Header-->
        <!--begin::Sidebar-->
        <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
            <!--begin::Sidebar Brand-->
            <div class="sidebar-brand" style="background: white;">
                <!--begin::Brand Link-->

                <a href="/" class="brand-link" style="text-align: center; margin: 0 auto;">
                    <img src="@siteSettings.SiteLogoUrl" style="max-height:30px;" />
                </a>
                <!--end::Brand Link-->
            </div>
            <!--end::Sidebar Brand-->
            <!--begin::Sidebar Wrapper-->
            <div class="sidebar-wrapper">
                <div class="user-panel mt-1 mb-1">

                    @if (SignInManager.IsSignedIn(User))
                    {
                        var user = await UserManager.GetUserAsync(User);
                        var roles = user != null ? await UserManager.GetRolesAsync(user) : new List<string>();
                        var hasMultipleRoles = roles.Count > 1;
                        var firstRole = roles.FirstOrDefault();

                        <div class="info">
                            <div class="user-name-display">
                                <i class="bi bi-person-circle me-1"></i> @user.FullName
                            </div>
                            <span class="btn btn-primary btn-xs mb-1" style="padding: 1px 6px; width: 100%; background: transparent; border: #c2c7d0; color: #d5d5d5; border: var(--bs-border-width) solid var(--bs-border-color); margin-top: 5px; text-align: left;"
                                  data-bs-toggle="@((hasMultipleRoles) ? "collapse" : null)"
                                  href="#rolesCollapse"
                                  role="button"
                                  aria-expanded="false"
                                  aria-controls="rolesCollapse">
                                @firstRole
                                @if (hasMultipleRoles)
                                {
                                    <i class="bi bi-caret-down-fill" style="float: right;"></i>
                                }
                            </span>

                            @if (hasMultipleRoles)
                            {
                                <div class="collapse mt-1" id="rolesCollapse">
                                    <div class="bg-primary text-white p-2 rounded" style="background: #c2c7d0; border: #c2c7d0; color: #343a40;">
                                        <ul class="list-unstyled mb-0">
                                            @foreach (var role in roles)
                                            {
                                                <li>
                                                    <i class="fas fa-check-circle text-success"></i> @role
                                                </li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            }

                        </div>
                    }

                </div>
                <!-- SidebarSearch Form -->
                @*<div class="form-inline">
                        <div class="input-group" data-widget="sidebar-search">
                            <input class="form-control form-control-sidebar" type="search" style="margin-right: 2px;" placeholder="Navigation/Menu" aria-label="Search" disabled="disabled">

                        </div>
                    </div>*@
                <nav class="mt-2">
                    <!--begin::Sidebar Menu-->
                    <ul class="nav sidebar-menu flex-column"
                        data-lte-toggle="treeview"
                        role="menu"
                        data-accordion="false">

                        <li class="nav-item">
                            <a asp-area="Admin" asp-page="/Dashboard/Index" class="nav-link">
                                <i class="nav-icon bi bi-speedometer2"></i>
                                <p>Dashboard</p>
                            </a>
                        </li>

                        @{
                            var usersAuth = await AuthorizationService.AuthorizeAsync(User, "UsersPolicy");
                            var postsAuth = await AuthorizationService.AuthorizeAsync(User, "PostsPolicy");
                            var commentsAuth = await AuthorizationService.AuthorizeAsync(User, "CommentsPolicy");
                            var categoriesAuth = await AuthorizationService.AuthorizeAsync(User, "CategoriesPolicy");
                            var mediaAuth = await AuthorizationService.AuthorizeAsync(User, "MediaFilesPolicy");
                            var settingsAuth = await AuthorizationService.AuthorizeAsync(User, "SettingsPolicy");
                            var webPagesAuth = await AuthorizationService.AuthorizeAsync(User, "WebPagesPolicy");
                        }
                        @if (webPagesAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/WebPages/Index" class="nav-link">
                                    <i class="nav-icon bi bi-window-sidebar"></i>
                                    <p>Web Pages</p>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Forms/Index" class="nav-link">
                                    <i class="nav-icon bi bi-ui-checks"></i> <!-- Different icon -->
                                    <p>Forms</p>
                                </a>
                            </li>
                        }

                        @if (categoriesAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Categories/Index" class="nav-link">
                                    <i class="nav-icon bi bi-card-checklist"></i>
                                    <p>Categories</p>
                                </a>
                            </li>
                        }
                        @if (postsAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Posts/Index" class="nav-link">
                                    <i class="nav-icon bi bi-stickies"></i>
                                    <p>Posts</p>
                                </a>
                            </li>
                        }

                        @if (commentsAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Comments/Index" class="nav-link">
                                    <i class="nav-icon bi bi-chat-dots-fill"></i>
                                    <p>Comments</p>
                                </a>
                            </li>
                        }



                        @if (mediaAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/MediaFiles/Index" class="nav-link">
                                    <i class="nav-icon bi bi-images"></i>
                                    <p>Media Files</p>
                                </a>
                            </li>
                        }
                        @if (usersAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Users/Index" class="nav-link">
                                    <i class="nav-icon bi bi-people-fill"></i>
                                    <p>Users</p>
                                </a>
                            </li>
                        }
                        @if (settingsAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Settings/Index" class="nav-link">
                                    <i class="nav-icon bi bi-gear"></i>
                                    <p>Settings</p>
                                </a>
                            </li>
                        }
                        @if (usersAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/Adverts/Index" class="nav-link">
                                    <i class="nav-icon bi bi-megaphone"></i>
                                    <p>Adverts</p>
                                </a>
                            </li>
                        }
                        <li class="nav-item">
                            <a asp-area="Admin" asp-page="/NewsletterAdmin/Index" class="nav-link">
                                <i class="nav-icon bi bi-envelope-paper"></i>
                                <p>Newsletter</p>
                            </a>
                        </li>

                        <li class="nav-item">
                            <a asp-area="Admin" asp-page="/SearchPanel/Index" class="nav-link">
                                <i class="nav-icon bi bi-search"></i>
                                <p>Advance Search</p>
                            </a>
                        </li>
                        @if (usersAuth.Succeeded)
                        {
                            <li class="nav-item">
                                <a asp-area="Admin" asp-page="/SystemLogs/Index" class="nav-link">
                                    <i class="nav-icon bi bi-file-earmark-text"></i>
                                    <p>Logs</p>
                                </a>
                            </li>
                        }
                        <li class="nav-item">
                            <a href="javascript:document.getElementById('logoutForm').submit()" class="nav-link">
                                <i class="nav-icon bi bi-box-arrow-right"></i>
                                <p>Logout</p>
                            </a>
                        </li>


                    </ul>
                    <!--end::Sidebar Menu-->
                </nav>
            </div>
            <!--end::Sidebar Wrapper-->
        </aside>
        <form asp-area="Identity" id="logoutForm" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Account/Login", new { area = "Identity" })" method="post">
        </form>
        <!--end::Sidebar-->
        <!--begin::App Main-->
        <main class="app-main">
            <!--begin::App Content Header-->
            <div class="app-content-header">
                <!--begin::Container-->
                <!--end::Container-->
            </div>
            <!--end::App Content Header-->
            <!--begin::App Content-->
            <div class="app-content">
                <!--begin::Container-->
                <div class="container-fluid">
                    <div class="card card-outline mb-4">

                        <div class="card-body">
                            <!--begin::Row-->
                            <div class="row">
                                <div class="col-sm-6"><h3 class="mb-0">Dashboard</h3></div>
                                <div class="col-sm-6 text-end">
                                    <div class="d-flex justify-content-end align-items-center gap-3">

                                        <!-- Full Greeting (Desktop) -->
                                        <span class="fw-bold d-none d-sm-inline">
                                            @($"Good {(DateTime.Now.Hour < 12 ? "Morning" : DateTime.Now.Hour < 18 ? "Afternoon" : "Evening")}, {User.Identity?.Name ?? "Guest"}")
                                        </span>

                                        <!-- Short Greeting (Mobile) -->
                                        <span class="fw-bold d-inline d-sm-none">
                                            @($"Good {(DateTime.Now.Hour < 12 ? "Morning" : DateTime.Now.Hour < 18 ? "Afternoon" : "Evening")}")
                                        </span>

                                        <!-- Current Time (Desktop only) -->
                                        <span id="live-time" class="text-muted d-none d-sm-inline"></span>
                                        @*<span class="text-muted d-none d-sm-inline">
                                                @DateTime.Now.ToString("dddd, dd MMM yyyy hh:mm tt")
                                            </span>*@

                                        <!-- Website Button (Desktop) -->
                                        <a asp-page="/Index" target="_blank" class="btn btn-primary btn-sm d-none d-sm-inline">
                                            <i class="fas fa-home"></i> Website
                                        </a>

                                        <!-- Home Icon Only (Mobile) -->
                                        <a asp-page="/Index" target="_blank" class="btn btn-primary btn-sm d-inline d-sm-none">
                                            <i class="fas fa-home"></i>
                                        </a>
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                    <!--end::Row-->
                </div>
                <div class="container-fluid" style="margin-top:10px;">
                    <div class="card card-outline mb-4">

                        <div class="card-body">
                            @RenderBody()
                        </div>
                    </div>



                </div>
                <!--end::Container-->
            </div>
            <!--end::App Content-->
        </main>

        <!--end::App Main-->
        <!--begin::Footer-->
        <footer class="app-footer">
            <!--begin::To the end-->
            <div class="float-end d-none d-sm-inline"></div>
            <!--end::To the end-->
            <!--begin::Copyright-->
            <strong>
                Copyright &copy; @DateTime.UtcNow.Year Developed by <a href="https://exwhyzee.ng/" target="_blank">EXWHYZEE Technologies Ltd</a>
            </strong>
            All rights reserved.
            <!--end::Copyright-->
        </footer>
        <!--end::Footer-->
    </div>
    <!--end::App Wrapper-->
    <!--begin::Script-->
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/browser/overlayscrollbars.browser.es6.min.js"
            integrity="sha256-dghWARbRe2eLlIJ56wNB+b760ywulqK3DzZYEpsg2fQ="
            crossorigin="anonymous"></script>
    <!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Required Plugin(popperjs for Bootstrap 5)-->
    <script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"></script>


    <script src="~/_content/AdminUI/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>


    <!--end::Required Plugin(popperjs for Bootstrap 5)--><!--begin::Required Plugin(Bootstrap 5)-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
            integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
            crossorigin="anonymous"></script>

    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote-lite.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>


    <!--end::Required Plugin(Bootstrap 5)--><!--begin::Required Plugin(AdminLTE)-->
    <script src="~/_content/AdminUI/dist/js/adminlte.js"></script>


    <script>
        $(document).ready(function () {
            $('.table_basic').DataTable({
                responsive: true,
                paging: true,
                lengthChange: true,
                searching: true,
                ordering: true,
                info: true,
                autoWidth: false,
                scrollX: true,
                lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]]
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $('.table_with_button').DataTable({
                dom: 'Bfrtip', // ✅ Add this line
                responsive: true,
                paging: true,
                lengthChange: true,
                searching: true,
                ordering: true,
                info: true,
                autoWidth: false,
                scrollX: true,
                lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]],
                buttons: [
                    {
                        extend: 'copy',
                        exportOptions: { columns: ':visible:not(.no-export)' }
                    },
                    {
                        extend: 'csv',
                        exportOptions: { columns: ':visible:not(.no-export)' }
                    },
                    {
                        extend: 'excel',
                        exportOptions: { columns: ':visible:not(.no-export)' }
                    },
                    {
                        extend: 'pdf',
                        exportOptions: { columns: ':visible:not(.no-export)' },
                        orientation: 'landscape',
                        customize: function (doc) {
                            doc.styles.tableHeader.alignment = 'left';
                            doc.content[1].table.widths = Array(doc.content[1].table.body[0].length + 1).join('*').split('');
                        },
                        pageSize: 'A4'
                    },
                    {
                        extend: 'print',
                        exportOptions: { columns: ':visible:not(.no-export)' }
                    }
                ],
                columnDefs: [
                    {
                        targets: 'no-export',
                        visible: false,
                        searchable: false
                    }
                ],
                initComplete: function () {
                    this.api().buttons().container().appendTo($(this).closest('.dataTables_wrapper').find('.col-md-6:eq(0)'));
                }
            });
        });
    </script>

    <script>
        $(document).ready(function () {
            $('.summernote_basic').summernote({
                height: 200,
                placeholder: 'Type here...',
                toolbar: [
                    ['style', ['style']],
                    ['font', ['bold', 'italic', 'underline', 'clear']],
                    ['fontsize', ['fontsize']],
                    ['para', ['ul', 'ol', 'paragraph']],
                    ['insert', ['link', 'picture', 'video']], // ✅ 'picture' re-enabled
                    ['view', ['fullscreen', 'codeview', 'help']]
                ],
                callbacks: {
                    onImageUpload: function () {
                        alert("Image upload is disabled. Please use an image URL instead.");
                    },
                    onPaste: function (e) {
                        const clipboardData = (e.originalEvent || e).clipboardData;
                        if (clipboardData && clipboardData.items) {
                            for (let i = 0; i < clipboardData.items.length; i++) {
                                if (clipboardData.items[i].type.indexOf("image") !== -1) {
                                    e.preventDefault();
                                    alert("Pasting images is disabled. Use image URLs instead.");
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>




    @if (TempData["success"] != null)
    {
        <script>

            toastr.success('@TempData["success"]')
        </script>
    }

    @if (TempData["error"] != null)
    {
        <script>

            toastr.error('@TempData["error"]')
        </script>
    }
    @if (TempData["info"] != null)
    {
        <script>

            toastr.success('@TempData["info"]')
        </script>
    }


    <!--end::Required Plugin(AdminLTE)--><!--begin::OverlayScrollbars Configure-->
    <script>
        const SELECTOR_SIDEBAR_WRAPPER = '.sidebar-wrapper';
        const Default = {
            scrollbarTheme: 'os-theme-light',
            scrollbarAutoHide: 'leave',
            scrollbarClickScroll: true,
        };
        document.addEventListener('DOMContentLoaded', function () {
            const sidebarWrapper = document.querySelector(SELECTOR_SIDEBAR_WRAPPER);
            if (sidebarWrapper && typeof OverlayScrollbarsGlobal?.OverlayScrollbars !== 'undefined') {
                OverlayScrollbarsGlobal.OverlayScrollbars(sidebarWrapper, {
                    scrollbars: {
                        theme: Default.scrollbarTheme,
                        autoHide: Default.scrollbarAutoHide,
                        clickScroll: Default.scrollbarClickScroll,
                    },
                });
            }
        });
    </script>
    <!--end::OverlayScrollbars Configure-->
    <!-- OPTIONAL SCRIPTS -->
    <!-- sortablejs -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"
            integrity="sha256-ipiJrswvAR4VAx/th+6zWsdeYmVae0iJuiR+6OqHJHQ="
            crossorigin="anonymous"></script>
    <!-- sortablejs -->
    <script>
        const connectedSortables = document.querySelectorAll('.connectedSortable');
        connectedSortables.forEach((connectedSortable) => {
            let sortable = new Sortable(connectedSortable, {
                group: 'shared',
                handle: '.card-header',
            });
        });

        const cardHeaders = document.querySelectorAll('.connectedSortable .card-header');
        cardHeaders.forEach((cardHeader) => {
            cardHeader.style.cursor = 'move';
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        window.addEventListener('load', function () {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                preloader.classList.add('fade-out');
                setTimeout(() => preloader.remove(), 300); // Remove spinner after fade
            }
        });
    </script>
    <script>
        document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(function (el) {
            new bootstrap.Tooltip(el);
        });

    </script>

    @await RenderSectionAsync("Scripts", required: false)


    <!--end::Script-->
    <script>
        function updateTime() {
            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'short',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            };

            document.getElementById("live-time").innerText =
                new Date().toLocaleString('en-US', options);
        }

        // Update immediately
        updateTime();

        // Update every second
        setInterval(updateTime, 1000);
    </script>
</body>
<!--end::Body-->
</html>

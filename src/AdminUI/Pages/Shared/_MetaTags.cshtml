@using ModelData.Services
@inject ISettingsService SettingsService
@{
    var siteSettings = await SettingsService.GetSettingsAsync();
    var request = Context.Request;
    string baseUrl = $"{request.Scheme}://{request.Host}";
    string title = ViewData["MetaTitle"] as string ?? siteSettings.SiteTitle ?? "AfriRanking";
    string description = ViewData["MetaDescription"] as string ?? siteSettings.SiteDescription ?? "";
    string author = ViewData["MetaAuthor"] as string ?? siteSettings.MetaAuthor ?? "Admin";
    string keywords = ViewData["MetaKeywords"] as string ?? siteSettings.MetaKeywords ?? "";

    string imageUrl = ViewData["MetaImage"] as string ?? siteSettings.SiteLogoUrl ?? "/assets/default.jpg";
    string url = ViewData["MetaUrl"] as string ?? $"{Context.Request.Scheme}://{Context.Request.Host}{Context.Request.Path}";
    string fullImageUrl = imageUrl.StartsWith("http") ? imageUrl : $"{baseUrl}{imageUrl}";

    var plainDescription = System.Text.RegularExpressions.Regex.Replace(description, "<.*?>", "");
}

<!-- Standard Meta -->
<meta name="description" content="@plainDescription" />
<meta name="author" content="@author" />
<meta name="robots" content="index, follow" />
<meta name="keywords" content="@keywords" />

<!-- Open Graph -->
<meta property="og:type" content="article" />
<meta property="og:title" content="@title" />
<meta property="og:description" content="@plainDescription" />
<meta property="og:url" content="@url" />
<meta property="og:image" content="@fullImageUrl" />
<meta property="og:site_name" content="@siteSettings.SiteTitle" />
<meta property="article:published_time" content="@ViewData["MetaPublished"]" />
<meta property="article:modified_time" content="@DateTime.UtcNow.ToString("o")" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="@title" />
<meta name="twitter:description" content="@plainDescription" />
<meta name="twitter:image" content="@fullImageUrl" />
<meta name="twitter:site" content="@siteSettings.TwitterUrl" />
<meta name="twitter:creator" content="@siteSettings.TwitterUrl" />

<!-- JSON-LD -->
<script type="application/ld+json">
{
  "@@context": "https://schema.org",
  "@@type": "BlogPosting",
  "headline": "@title",
  "description": "@plainDescription",
  "image": "@url@imageUrl",
  "author": { "@@type": "Person", "name": "@author" },
  "publisher": {
    "@@type": "Organization",
    "name": "@siteSettings.SiteTitle",
    "logo": { "@@type": "ImageObject", "url": "@url@(siteSettings.SiteLogoUrl ?? "/logo.png")" }
  },
  "datePublished": "@ViewData["MetaPublished"]",
  "dateModified": "@DateTime.UtcNow.ToString("o")",
  "mainEntityOfPage": { "@@type": "WebPage", "@@id": "@url" }
}
</script>
